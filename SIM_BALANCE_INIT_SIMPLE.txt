================================================================================
                    SIM BALANCE INITIALIZATION - SIMPLE VIEW
================================================================================

WHEN YOU RUN: python main.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Python loads main.py
        â””â”€ Calls MainWindow()

STEP 2: MainWindow.__init__() starts
        â””â”€ Calls _setup_state_manager()

STEP 3: StateManager() is created
        â””â”€ Line 33: self.sim_balance = 10000.0

           THIS IS THE MAGIC LINE!
           â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘

STEP 4: StateManager registers globally
        â””â”€ Can be accessed from anywhere in the app
           from core.app_state import get_state_manager
           state = get_state_manager()
           print(state.sim_balance)  # Will show 10000.0

STEP 5: Panel1 is created and displays the balance
        â””â”€ Panel1.__init__()
           â””â”€ Shows $10,000.00 on screen

STEP 6: SimBalanceManager loads (or creates) persistence file
        â””â”€ If data/sim_balance.json exists: load from it
        â””â”€ If file doesn't exist: use default 10000.0
        â””â”€ If new month: reset to 10000.0

RESULT: Your app shows $10,000.00 balance
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

WHERE IS IT SET?
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

File:    core/state_manager.py
Line:    33
Code:    self.sim_balance: float = 10000.0

This is a Python class variable being set during __init__()

It's hardcoded in the source code, so it's always 10000.0 on startup.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

THE COMPLETE INITIALIZATION SEQUENCE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

python main.py
    â”‚
    â”œâ”€> QApplication created (PyQt6 app)
    â”‚
    â”œâ”€> MainWindow() called
    â”‚   â”‚
    â”‚   â”œâ”€> _setup_window()
    â”‚   â”‚
    â”‚   â”œâ”€> _setup_state_manager()  â† THIS IS THE KEY ONE!
    â”‚   â”‚   â”‚
    â”‚   â”‚   â””â”€> StateManager()
    â”‚   â”‚       â”‚
    â”‚   â”‚       â”œâ”€> self.sim_balance = 10000.0       â† SET HERE!
    â”‚   â”‚       â”œâ”€> self.live_balance = 0.0
    â”‚   â”‚       â”œâ”€> self.current_mode = "SIM"
    â”‚   â”‚       â””â”€> ... other stuff ...
    â”‚   â”‚   â”‚
    â”‚   â”‚   â””â”€> set_state_manager(self._state)
    â”‚   â”‚       â””â”€> Register globally for access
    â”‚   â”‚
    â”‚   â”œâ”€> _setup_theme()
    â”‚   â”‚
    â”‚   â”œâ”€> _build_ui()
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€> Panel1.__init__()
    â”‚   â”‚   â”‚   â”‚
    â”‚   â”‚   â”‚   â”œâ”€> _equity_points_sim = []
    â”‚   â”‚   â”‚   â”œâ”€> _equity_points_live = []
    â”‚   â”‚   â”‚   â””â”€> Shows $10,000.00 on screen
    â”‚   â”‚   â”‚
    â”‚   â”‚   â””â”€> Panel2.__init__()
    â”‚   â”‚       â””â”€> Ready to receive DTC messages
    â”‚   â”‚
    â”‚   â”œâ”€> _setup_reset_balance_hotkey()
    â”‚   â”‚   â””â”€> Registers Ctrl+Shift+R
    â”‚   â”‚
    â”‚   â””â”€> ... more setup ...
    â”‚
    â””â”€> win.show()
        â””â”€> Display the GUI with balance = $10,000.00

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

THREE SCENARIOS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SCENARIO 1: First Time Running App
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
data/sim_balance.json    Does not exist yet

StateManager.sim_balance = 10000.0
SimBalanceManager._balance = 10000.0 (default)
_check_monthly_reset()   No file, use default

Result:  Shows $10,000.00 âœ“


SCENARIO 2: Close App and Reopen Same Month
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
data/sim_balance.json    Exists with:
                         {
                           "balance": 10500.00,
                           "last_reset_month": "2025-11"
                         }

StateManager.sim_balance = 10000.0 (initial)
SimBalanceManager._load()  Load from JSON
SimBalanceManager._balance = 10500.00 (from file)
_check_monthly_reset()     Month same, no reset

Result:  Shows $10,500.00 âœ“ (your trades were saved!)


SCENARIO 3: Close App and Reopen Next Month
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
data/sim_balance.json    Exists with:
                         {
                           "balance": 10500.00,
                           "last_reset_month": "2025-10"
                         }

StateManager.sim_balance = 10000.0 (initial)
SimBalanceManager._load()  Load from JSON (10500.00)
_check_monthly_reset()     Month changed!
                          Reset to 10000.0
                          Save new month

Result:  Shows $10,000.00 âœ“ (monthly reset!)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TIMELINE (From Button Click to Showing Balance):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

T=0ms   User double-clicks app icon or runs "python main.py"

T=50ms  Python interpreter starts
        main.py begins executing
        QtWidgets.QApplication created

T=100ms MainWindow.__init__() starts
        _setup_state_manager() called

T=150ms StateManager.__init__() executes
        self.sim_balance = 10000.0  â† BALANCE SET!

T=200ms StateManager registers globally
        SimBalanceManager checks for file

T=250ms Panel1.__init__() runs
        UI elements created

T=300ms Panel1.lbl_balance.setText("$10,000.00")

T=350ms win.show() displays the window

T=400ms User sees $10,000.00 on screen! âœ“

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

KEY TAKEAWAYS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. SIM balance is ALWAYS initialized to $10,000.00 in StateManager

2. This happens AUTOMATICALLY when the app starts

3. The value comes from a hardcoded line in state_manager.py:
   self.sim_balance: float = 10000.0

4. SimBalanceManager can OVERRIDE this if:
   - A persistence file exists (data/sim_balance.json)
   - Or if a new month started (auto-reset)

5. The balance is shown in Panel1 label

6. Everything happens in milliseconds, before user sees anything

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TWO CLASS VARIABLES WITH THE SAME VALUE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

StateManager (state_manager.py:33):
    self.sim_balance: float = 10000.0

SimBalanceManager (sim_balance.py:20):
    SIM_STARTING_BALANCE: float = 10000.00

Both are 10000.0, so consistency is guaranteed.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

THAT'S IT!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

When you run your app, the sim_balance is automatically set to $10,000.00.
Then it can be updated by:
  - DTC balance messages (from Sierra Chart)
  - Trade P&L (when trades close)
  - Manual reset (Ctrl+Shift+R)
  - Monthly auto-reset (next calendar month)

All automatic. All tracked. All persisted.

Ready to test! ğŸš€
